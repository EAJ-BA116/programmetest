<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />

  <title>Programme EAJ â€“ BA 116</title>

  <!-- Couleur navigateur -->
  <meta name="theme-color" content="#0053a6">

  <!-- PWA Android -->
  <link rel="manifest" href="manifest.json?v=1.2.1">

  <!-- iOS PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="EAJ 116">
  <link rel="apple-touch-icon" href="images/logo_eaj192.png?v=1.2.1">

  <!-- IcÃ´nes Android -->
  <link rel="icon" type="image/png" sizes="192x192" href="images/logo_eaj192.png?v=1.2.1">
  <link rel="icon" type="image/png" sizes="512x512" href="images/logo_eaj512.png?v=1.2.1">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="images/eaj.ico?v=1.2.1">

  <link id="main-style" rel="stylesheet" href="style.css?v=1.2.1">
</head>

<body data-theme="dark">
  <!-- âš ï¸ BanniÃ¨res dâ€™alerte -->
  <div id="alert-banner"></div>

  <header class="app-header">
    <div class="header-left">
      <img class="app-logo" src="images/logo_eaj.png" alt="Logo Escadrilles Air Jeunesse">
      <div class="site-title-text">
        <h1>Escadrilles Air Jeunesse</h1>
        <p>BA 116 â€“ Programme des activitÃ©s</p>
        <div class="badge-time">â± Mercredi aprÃ¨s-midi â€¢ 14hâ€“17h (et Ã©vÃ©nements ponctuels)</div>
      </div>
    </div>

    <button id="menu-toggle" class="btn-menu" type="button" aria-label="Ouvrir le menu" aria-controls="app-menu" aria-expanded="false">
      â‹¯
    </button>
  </header>

  <!-- Barre filtres + options -->
  <div id="filter-bar" role="navigation" aria-label="Filtres">
    <div id="filter-buttons">
      <button class="btn-filter" data-filter="all">Tous</button>
      <button class="btn-filter" data-filter="EAJ1">EAJ1</button>
      <button class="btn-filter" data-filter="EAJ2">EAJ2</button>
      <button class="btn-filter" data-filter="EAJ3">EAJ3</button>
    </div>

    <div class="filter-actions">
      <label class="toggle-banners" title="Masquer/afficher les banniÃ¨res (non mÃ©morisÃ©)">
        <input type="checkbox" id="banner-toggle" checked>
        <span>Afficher banniÃ¨res</span>
      </label>

      <button id="theme-toggle" class="btn-theme" type="button">ğŸŒ™ Mode sombre</button>
    </div>
    <div class="filter-help">ğŸ’¡ Filtres : sÃ©lectionne un groupe pour afficher ses activitÃ©s. â€œTousâ€ affiche tout (y compris les activitÃ©s communes).</div>
  </div>

  <!-- ğŸ¨ LÃ©gende (dÃ©pliable, fermÃ©e par dÃ©faut) -->
  <details class="legend-details" id="legend">
    <summary>ğŸ¨ LÃ©gende des activitÃ©s</summary>
    <div class="legend-line">
      ğŸ“˜ BIA &nbsp;â€¢&nbsp;
      ğŸƒâ€â™‚ï¸ Sport &nbsp;â€¢&nbsp;
      ğŸ›ï¸ Visite &nbsp;â€¢&nbsp;
      ğŸ› ï¸ Projet &nbsp;â€¢&nbsp;
      âœˆï¸ AÃ©romodÃ©lisme &nbsp;â€¢&nbsp;
      ğŸ›¸ Drone &nbsp;â€¢&nbsp;
      ğŸ¯ Tir &nbsp;â€¢&nbsp;
      ğŸ¤ Rencontres &nbsp;â€¢&nbsp;
      ğŸ•¯ï¸ Devoir de mÃ©moire &nbsp;â€¢&nbsp;
      ğŸ–ï¸ CÃ©rÃ©monie &nbsp;â€¢&nbsp;
      âœ¨ Autres
    </div>
  </details>

  <main class="container">
<div id="week-container"></div>
  </main>

  <!-- âœ… Bas de page -->
  <footer>
    <div class="footer-line">EAJ BA 116 â€“ 2025</div>
    <div class="footer-line" id="last-update"></div>
    <div class="footer-line footer-version">Version 1.2.1 du 25/01/2026 â€¢ CodÃ© par Yoann</div>
    <div class="footer-line">
      <a href="#" id="admin-link" class="footer-link footer-link-admin">ğŸ”§ AccÃ¨s administration</a>
    </div>
  </footer>

  <!-- ğŸ” FenÃªtre modale code admin -->
  <div id="admin-modal" class="admin-modal" aria-hidden="true">
    <div class="admin-modal-backdrop"></div>
    <div class="admin-modal-dialog">
      <h2>AccÃ¨s administrateur</h2>
      <p class="admin-modal-text">
        <strong>Outil interne : gÃ©nÃ©ration du planning.</strong><br>
        Rien nâ€™est publiÃ© automatiquement, rien nâ€™est enregistrÃ© cÃ´tÃ© serveur.<br>
        Code requis uniquement pour Ã©viter les clics accidentels.
      </p>
      <input type="password" id="admin-code-input" placeholder="Code dâ€™accÃ¨s" />
      <div class="admin-modal-actions">
        <button type="button" id="admin-cancel" class="btn-admin btn-admin-secondary">Annuler</button>
        <button type="button" id="admin-validate" class="btn-admin btn-admin-primary">Valider</button>
      </div>
      <p class="admin-error" id="admin-error" style="display:none;">Code incorrect. Merci de vÃ©rifier.</p>
    </div>
  </div>

  <!-- âœˆï¸ Retour en haut -->
  <button id="back-to-top" class="back-to-top air-patch" type="button" aria-label="Retour en haut">âœˆï¸</button>
  <!-- â‹¯ Menu compact -->
  <div id="app-menu" class="menu-popover" aria-hidden="true">
    <div class="menu-popover-panel" role="dialog" aria-modal="true" aria-label="Menu">
      <div class="menu-popover-header">
        <div class="menu-popover-title">Menu</div>
        <button class="menu-popover-close" type="button" data-menu-close aria-label="Fermer le menu">âœ•</button>
      </div>

      <label class="menu-field">
        <span>Nos projets</span>

        <button id="projects-btn" class="projects-trigger" type="button" aria-haspopup="listbox" aria-expanded="false">
          Ouvrir un projetâ€¦
          <span class="projects-chevron" aria-hidden="true">â–¾</span>
        </button>

        <div id="projects-list" class="projects-list" role="listbox" aria-label="Nos projets" hidden>
          <button class="projects-item" type="button" role="option" data-url="https://eaj-ba116.github.io/HenriFertet2025/">2025 â€“ Henri Fertet</button>
          <button class="projects-item" type="button" role="option" data-url="https://eaj-ba116.github.io/operationsagittaire/">2025 â€“ OpÃ©ration Sagittaire</button>
        </div>
      </label>

      <nav class="menu-buttons" aria-label="Actions">
        <button class="menu-item" type="button" data-action="open-about">â„¹ï¸ Version & changelog</button>
        <button class="menu-item" type="button" data-action="open-admin">ğŸ”§ AccÃ¨s admin</button>
        <button class="menu-item" type="button" data-action="open-contact">ğŸ“² Bug / Contact</button>
      </nav>

      <div class="menu-popover-footer muted">Version 1.2.1 â€¢ 25/01/2026</div>
    </div>
  </div>

  <!-- â„¹ï¸ Modal Ã€ propos / Changelog -->

  <div id="about-modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" data-modal-close="about-modal"></div>
    <div class="modal-dialog" role="dialog" aria-modal="true" aria-label="Version et changelog">
      <div class="modal-header">
        <h2>Version & changelog</h2>
        <button class="modal-close" type="button" data-modal-close="about-modal" aria-label="Fermer">âœ•</button>
      </div>

      <div class="modal-body">
        <p class="modal-meta"><strong>Programme EAJ â€“ BA 116</strong><br>Version <strong>1.2.1</strong> â€¢ 25/01/2026 â€¢ CodÃ© par <strong>Yoann</strong></p>

        <div class="changelog">
          <div class="changelog-title">DerniÃ¨res modifications</div>
          <ul>
            <li>Correctif : â€œAfficher banniÃ¨resâ€ masque/affiche vraiment</li>
            <li>GÃ©nÃ©rateur : semaines rÃ©ordonnÃ©es par date (ajout â†’ bon endroit)</li>
            <li>GÃ©nÃ©rateur : banniÃ¨res avec dates dÃ©but (auto = aujourdâ€™hui) / fin (optionnel)</li>
            <li>Mobile : zoom dÃ©sactivÃ© + fin du â€œscroll Ã  droiteâ€</li>
            <li>Correctif : fenÃªtre admin au-dessus des autres Ã©lÃ©ments</li>
</ul>
        </div>
      </div>
    </div>
  </div>

  <!-- âœ‰ï¸ Modal contact -->
  <div id="contact-modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" data-modal-close="contact-modal"></div>
    <div class="modal-dialog" role="dialog" aria-modal="true" aria-label="Contact">
      <div class="modal-header">
        <h2>Signaler un bug / Contact</h2>
        <button class="modal-close" type="button" data-modal-close="contact-modal" aria-label="Fermer">âœ•</button>
      </div>

      <div class="modal-body">
        <p class="modal-meta">DÃ©cris le souci : la version et le lien de la page seront ajoutÃ©s automatiquement. Tu peux ensuite ouvrir WhatsApp ou copier le message.</p>

        <label class="modal-field">
          <span>Message</span>
          <textarea id="contact-message" rows="6" placeholder="Ex: Sur mobile, le filtre EAJ2 ne masque pas les activitÃ©s communesâ€¦

Ã‰tapes pour reproduire :
1) â€¦
2) â€¦
RÃ©sultat obtenu : â€¦
RÃ©sultat attendu : â€¦"></textarea>
        </label>

        <div class="modal-actions">
          <button id="open-whatsapp" class="btn-primary" type="button">Ouvrir WhatsApp</button>
          <button id="copy-contact" class="btn-secondary" type="button">Copier le message</button>
          <button class="btn-secondary" type="button" data-modal-close="contact-modal">Fermer</button>
        </div>

        <p class="modal-hint" id="copy-hint" aria-live="polite"></p>
      </div>
    </div>
  </div>

  <!-- âš™ï¸ JS : dâ€™abord planning.js (avec version), puis la logique -->
  <script>
  // Cache-buster global (Ã©vite les "versions fantÃ´mes" sur GitHub Pages)
  window.EAJ_BUILD = "1.2.1";
  (function () {
    const bust = Date.now();
    const s = document.createElement('script');
    s.src = `version-loader.js?v=1.2.1-${bust}`;
    document.head.appendChild(s);
  })();
</script>
</body>
</html>
